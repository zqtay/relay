"use strict";(self.webpackChunkrelay=self.webpackChunkrelay||[]).push([[353],{3353:function(e,n,t){t.r(n),t.d(n,{default:function(){return I}});var r=t(2982),o=t(8683),a=t(885),u=t(2791),c=t(3504),i=t(184),s=function(e){var n=e.wordIndex,t=e.mode,r=e.state,c=e.selected,s=e.setSelected,l=r.inputs[n],f=r.hints[n],x=(0,u.useState)(l.split("")),v=(0,a.Z)(x,2),h=v[0],b=v[1],p=(0,u.useRef)(null);(0,u.useEffect)((function(){b(l.split(""))}),[l]);var w="wordbox";return c.wordIndex===n&&(w+=" wordbox-selected"),(0,i.jsx)("div",{tabIndex:0,className:w,ref:p,onClick:function(){s((function(e){return(0,o.Z)((0,o.Z)({},e),{},{wordIndex:n})}))},onBlur:function(){s({wordIndex:-1,charIndex:-1})},children:(0,i.jsx)(d,{charArray:h,wordIndex:n,selected:c,hint:f,mode:t,updateSelected:function(e){s({wordIndex:n,charIndex:e})}})})},d=function(e){for(var n=e.charArray,t=e.wordIndex,r=e.selected,o=e.hint,a=e.mode,u=e.updateSelected,c=[],s=null,d=function(e){s=l(t,e,r,o[e],a),c.push((0,i.jsxs)("div",{className:s,onClick:function(){return u(e)},children:[(0,i.jsx)("div",{className:"charbox-text",children:n[e]}),(0,i.jsx)("div",{className:"charbox-underline"})]},e))},f=0;f<n.length;f++)d(f);return(0,i.jsx)(i.Fragment,{children:c})},l=function(e,n,t,r,o){var a="charbox";return" "!==r&&(a+=" charbox-hint"),(n<o.overlapLen&&e>0||n>=o.wordLen-o.overlapLen&&e<o.noOfWords-1)&&(a+=" charbox-overlap"),e===t.wordIndex&&n===t.charIndex&&(a+=" charbox-selected"),a},f=(0,u.memo)(s),x=function(e){var n=e.keys,t=e.boardRef,r=function(e){e.preventDefault()};return(0,i.jsx)("div",{className:"d-flex flex-wrap align-items-center justify-content-center",children:n.map((function(e,n){return(0,i.jsx)("div",{className:"key-button",onClick:function(n){return function(e,n){var r=new KeyboardEvent("keydown_buttons",{key:e});t.current.dispatchEvent(r)}(e)},onMouseDown:r,children:e},n)}))})},v=-1,h=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=(0,u.useRef)(null),o=(0,u.useRef)(null);(0,u.useEffect)((function(){r.current=v,o.current=!1}),[]);var a=(0,u.useCallback)((function(){e(),o.current=!1,r.current=v}),[e]),c=(0,u.useCallback)((function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n&&e.preventDefault(),o.current||(r.current=setTimeout(a,t),o.current=!0)}),[t,a]),i=(0,u.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&e.preventDefault(),r.current!==v&&o.current&&(clearTimeout(r.current),r.current=v),o.current&&n(),o.current=!1}),[n]);return{onMouseDown:function(e){return c(e)},onTouchStart:function(e){return c(e,!1)},onMouseUp:function(e){return i(e)},onTouchEnd:function(e){return i(e)}}},b=t(917),p=t(8587),w=(0,u.lazy)((function(){return t.e(391).then(t.bind(t,4391))})),m={res:null,data:""},k=function(e){var n=(0,u.useState)(p.BH),t=(0,a.Z)(n,2),s=t[0],d=t[1],l=(0,u.useState)(p.vJ),v=(0,a.Z)(l,2),h=v[0],k=v[1],I=(0,u.useState)([]),E=(0,a.Z)(I,2),j=E[0],y=E[1],Z=(0,u.useState)({wordIndex:-1,charIndex:-1}),N=(0,a.Z)(Z,2),g=N[0],R=N[1],S=(0,u.useState)(m),A=(0,a.Z)(S,2),L=A[0],q=A[1],D=(0,u.useState)(!1),T=(0,a.Z)(D,2),B=T[0],z=T[1],H=(0,c.lr)(),K=(0,a.Z)(H,2),O=K[0],W=(K[1],(0,u.useRef)(null));(0,u.useEffect)((function(){var e,n=O.get("puzzle");e=null!==n?b.q.genPuzzleFromEncoded(n):b.q.genPuzzle(),d(b.q.getMode().data),k(e.data),y(b.q.getKeys().data),z(!1),q(m)}),[O]);var P=function(e){q(m);var n=e.key.toUpperCase(),t=g.wordIndex,a=g.charIndex;if(-1!==t){if(a>=s.wordLen||a<0)if(1===n.length&&-1===a)a=0;else if("ENTER"!==n)return;var u=(0,r.Z)(h.inputs),c=u[t].split(""),i=h.hints[t];1===n.length?(a<s.wordLen&&" "===i[a]&&(c[a]=n,u[t]=c.join(""),k((function(e){return(0,o.Z)((0,o.Z)({},e),{},{inputs:u})}))),a<s.wordLen-1&&a++):"DELETE"===n||"BACKSPACE"===n?(" "===i[a]&&(c[a]=" ",u[t]=c.join(""),k((function(e){return(0,o.Z)((0,o.Z)({},e),{},{inputs:u})}))),"BACKSPACE"===n&&a>0&&a--):"ENTER"===n?function(e,n){q(m);var t=b.q.validateInput(e,n);q(t)}(t,c.join("")):"ARROWLEFT"===n?a>0&&a--:"ARROWRIGHT"===n?a<s.wordLen-1&&a++:"ARROWUP"===n?t>0&&t--:"ARROWDOWN"===n&&t<s.noOfWords-1&&t++,R({wordIndex:t,charIndex:a})}},M=function(e){var n=new KeyboardEvent("keydown_buttons",{key:e});W.current.dispatchEvent(n)};return(0,u.useEffect)((function(){var e=W.current;return e.addEventListener("keydown_buttons",P),function(){e.removeEventListener("keydown_buttons",P)}}),[P]),(0,i.jsxs)("div",{className:"container board",children:[(0,i.jsx)("div",{tabIndex:0,className:"board-panel",ref:W,onKeyDown:P,children:h.inputs.map((function(e,n){return(0,i.jsx)(f,{wordIndex:n,mode:s,state:h,selected:g,setSelected:R},n)}))}),(0,i.jsxs)("div",{className:"board-control",children:[(0,i.jsx)("div",{className:"board-status",children:"".concat(L.data)}),(0,i.jsx)(C,{onClickClear:function(){q(m);var e=(0,o.Z)({},h);e.inputs=(0,r.Z)(e.hints),k(e)},onClickHint:function(){q(m);var e=null;if((e=-1===g.charIndex?b.q.addHint(g.wordIndex):b.q.addHint(g.wordIndex,g.charIndex)).status===p.bb){var n=(0,o.Z)({},h),t=W.current.getElementsByClassName("wordbox")[g.wordIndex].textContent;n.hints=(0,r.Z)(b.q.getHints().data),n.inputs[g.wordIndex]=t.slice(0,e.data.index)+e.data.hint+t.slice(e.data.index+1),k(n)}else q(e)},onClickSubmit:function(){q(m);var e=Array.from(W.current.getElementsByClassName("wordbox")).map((function(e){return e.textContent})),n=b.q.validateAll(e);q(n),n.status===p.bb&&z(!0)},onClickValid:function(){return M("ENTER")},onClickBackspace:function(){return M("BACKSPACE")}}),(0,i.jsx)(x,{keys:j,boardRef:W})]}),(0,i.jsx)(u.Suspense,{children:(0,i.jsx)(w,{show:B,inputs:h.inputs,dismiss:function(){return z(!1)}})})]})},C=function(e){var n=e.onClickClear,t=e.onClickHint,r=e.onClickSubmit,a=e.onClickValid,u=e.onClickBackspace,c=h(n,u),s=h(r,a);return(0,i.jsxs)("div",{children:[(0,i.jsx)("i",{className:"fa-solid fa-2x fa-square-h board-icon-button",onClick:t,onMouseDown:function(e){return e.preventDefault()}}),(0,i.jsx)("i",(0,o.Z)({className:"fa-regular fa-2x fa-circle-check board-icon-button"},s)),(0,i.jsx)("i",(0,o.Z)({className:"fa-solid fa-2x fa-left-long board-icon-button"},c))]})},I=(0,u.memo)(k)}}]);
//# sourceMappingURL=353.6d968ade.chunk.js.map