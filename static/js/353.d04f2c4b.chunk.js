"use strict";(self.webpackChunkrelay=self.webpackChunkrelay||[]).push([[353],{3353:function(n,e,t){t.r(e),t.d(e,{default:function(){return C}});var r=t(2982),o=t(8683),a=t(885),u=t(2791),c=t(3504),s=t(184),i=function(n){var e=n.wordIndex,t=n.mode,r=n.state,c=n.selected,i=n.setSelected,l=r.inputs[e],f=r.hints[e],x=(0,u.useState)(l.split("")),v=(0,a.Z)(x,2),h=v[0],b=v[1],p=(0,u.useRef)(null);(0,u.useEffect)((function(){b(l.split(""))}),[l]);var w="wordbox";return c.wordIndex===e&&(w+=" wordbox-selected"),(0,s.jsx)("div",{tabIndex:0,className:w,ref:p,onClick:function(){i((function(n){return(0,o.Z)((0,o.Z)({},n),{},{wordIndex:e})}))},onBlur:function(){i({wordIndex:-1,charIndex:-1})},children:(0,s.jsx)(d,{charArray:h,wordIndex:e,selected:c,hint:f,mode:t,updateSelected:function(n){i({wordIndex:e,charIndex:n})}})})},d=function(n){for(var e=n.charArray,t=n.wordIndex,r=n.selected,o=n.hint,a=n.mode,u=n.updateSelected,c=[],i=null,d=function(n){i=l(t,n,r,o[n],a),c.push((0,s.jsxs)("div",{className:i,onClick:function(){return u(n)},children:[(0,s.jsx)("div",{className:"charbox-text",children:e[n]}),(0,s.jsx)("div",{className:"charbox-underline"})]},n))},f=0;f<e.length;f++)d(f);return(0,s.jsx)(s.Fragment,{children:c})},l=function(n,e,t,r,o){var a="charbox";return" "!==r&&(a+=" charbox-hint"),(e<o.overlapLen&&n>0||e>=o.wordLen-o.overlapLen&&n<o.noOfWords-1)&&(a+=" charbox-overlap"),n===t.wordIndex&&e===t.charIndex&&(a+=" charbox-selected"),a},f=(0,u.memo)(i),x=function(n){var e=n.keys,t=n.boardRef,r=function(n){n.preventDefault()};return(0,s.jsx)("div",{className:"d-flex flex-wrap align-items-center justify-content-center",children:e.map((function(n,e){return(0,s.jsx)("div",{className:"key-button",onClick:function(e){return function(n,e){var r=new KeyboardEvent("keydown_buttons",{key:n});t.current.dispatchEvent(r)}(n)},onMouseDown:r,children:n},e)}))})},v=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=(0,u.useRef)(null),o=(0,u.useRef)(null),a=(0,u.useRef)(null);(0,u.useEffect)((function(){r.current=-1,o.current=!1,a.current=!1}),[]);var c=(0,u.useCallback)((function(){a.current=!0,n()}),[n]),s=(0,u.useCallback)((function(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&n.preventDefault(),o.current||(r.current=setTimeout(c,t),o.current=!0)}),[t,c]),i=(0,u.useCallback)((function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&n.preventDefault(),-1!==r.current&&o.current&&(clearTimeout(r.current),r.current=-1,o.current=!1),a.current||e(),a.current=!1}),[e]);return{onMouseDown:function(n){return s(n)},onTouchStart:function(n){return s(n,!1)},onMouseUp:function(n){return i(n)},onTouchEnd:function(n){return i(n)}}},h=t(917),b=t(8587),p=(0,u.lazy)((function(){return t.e(391).then(t.bind(t,4391))})),w={res:null,data:""},m=function(n){var e=(0,u.useState)(b.BH),t=(0,a.Z)(e,2),i=t[0],d=t[1],l=(0,u.useState)(b.vJ),v=(0,a.Z)(l,2),m=v[0],C=v[1],I=(0,u.useState)([]),j=(0,a.Z)(I,2),E=j[0],y=j[1],Z=(0,u.useState)({wordIndex:-1,charIndex:-1}),N=(0,a.Z)(Z,2),R=N[0],S=N[1],g=(0,u.useState)(w),A=(0,a.Z)(g,2),L=A[0],q=A[1],D=(0,u.useState)(!1),B=(0,a.Z)(D,2),T=B[0],z=B[1],H=(0,c.lr)(),K=(0,a.Z)(H,2),O=K[0],W=(K[1],(0,u.useRef)(null));(0,u.useEffect)((function(){var n,e=O.get("puzzle");n=null!==e?h.q.genPuzzleFromEncoded(e):h.q.genPuzzle(),d(h.q.getMode().data),C(n.data),y(h.q.getKeys().data),z(!1),q(w)}),[O]);var P=function(n){q(w);var e=R.wordIndex,t=R.charIndex;if(!(t>=i.wordLen||t<0)){var a=n.key.toUpperCase(),u=(0,r.Z)(m.inputs),c=u[e].split(""),s=m.hints[e];1===a.length?(t<i.wordLen&&" "===s[t]&&(c[t]=a,u[e]=c.join(""),C((function(n){return(0,o.Z)((0,o.Z)({},n),{},{inputs:u})}))),t<i.wordLen-1&&t++):"DELETE"===a||"BACKSPACE"===a?(" "===s[t]&&(c[t]=" ",u[e]=c.join(""),C((function(n){return(0,o.Z)((0,o.Z)({},n),{},{inputs:u})}))),"BACKSPACE"===a&&t>0&&t--):"ENTER"===a?function(n,e){q(w);var t=h.q.validateInput(n,e);q(t)}(e,c.join("")):"ARROWLEFT"===a?t>0&&t--:"ARROWRIGHT"===a?t<i.wordLen-1&&t++:"ARROWUP"===a?e>0&&e--:"ARROWDOWN"===a&&e<i.noOfWords-1&&e++,S({wordIndex:e,charIndex:t})}},M=function(n){var e=new KeyboardEvent("keydown_buttons",{key:n});W.current.dispatchEvent(e)};return(0,u.useEffect)((function(){var n=W.current;return n.addEventListener("keydown_buttons",P),function(){n.removeEventListener("keydown_buttons",P)}}),[P]),(0,s.jsxs)("div",{className:"container board",children:[(0,s.jsx)("div",{tabIndex:0,className:"board-panel",ref:W,onKeyDown:P,children:m.inputs.map((function(n,e){return(0,s.jsx)(f,{wordIndex:e,mode:i,state:m,selected:R,setSelected:S},e)}))}),(0,s.jsxs)("div",{className:"board-control",children:[(0,s.jsx)("div",{className:"board-status",children:"".concat(L.data)}),(0,s.jsx)(k,{onClickClear:function(){q(w);var n=(0,o.Z)({},m);n.inputs=(0,r.Z)(n.hints),C(n)},onClickHint:function(){q(w);var n=null;if((n=-1===R.charIndex?h.q.addHint(R.wordIndex):h.q.addHint(R.wordIndex,R.charIndex)).status===b.bb){var e=(0,o.Z)({},m),t=W.current.getElementsByClassName("wordbox")[R.wordIndex].textContent;e.hints=(0,r.Z)(h.q.getHints().data),e.inputs[R.wordIndex]=t.slice(0,n.data.index)+n.data.hint+t.slice(n.data.index+1),C(e)}else q(n)},onClickSubmit:function(){q(w);var n=Array.from(W.current.getElementsByClassName("wordbox")).map((function(n){return n.textContent})),e=h.q.validateAll(n);q(e),e.status===b.bb&&z(!0)},onClickValid:function(){return M("ENTER")},onClickBackspace:function(){return M("BACKSPACE")}}),(0,s.jsx)(x,{keys:E,boardRef:W})]}),(0,s.jsx)(u.Suspense,{children:(0,s.jsx)(p,{show:T,inputs:m.inputs,dismiss:function(){return z(!1)}})})]})},k=function(n){var e=n.onClickClear,t=n.onClickHint,r=n.onClickSubmit,a=n.onClickValid,u=n.onClickBackspace,c=v(e,u),i=v(r,a);return(0,s.jsxs)("div",{children:[(0,s.jsx)("i",{className:"fa-solid fa-2x fa-square-h board-icon-button",onClick:t,onMouseDown:function(n){return n.preventDefault()}}),(0,s.jsx)("i",(0,o.Z)({className:"fa-regular fa-2x fa-circle-check board-icon-button"},i)),(0,s.jsx)("i",(0,o.Z)({className:"fa-solid fa-2x fa-left-long board-icon-button"},c))]})},C=(0,u.memo)(m)}}]);
//# sourceMappingURL=353.d04f2c4b.chunk.js.map