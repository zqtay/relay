"use strict";(self.webpackChunkrelay=self.webpackChunkrelay||[]).push([[353],{3353:function(n,e,t){t.r(e),t.d(e,{default:function(){return I}});var r=t(2982),o=t(8683),a=t(885),u=t(2791),c=t(3504),i=t(184),s=function(n){var e=n.wordIndex,t=n.mode,r=n.state,c=n.selected,s=n.setSelected,l=r.inputs[e],f=r.hints[e],x=(0,u.useState)(l.split("")),v=(0,a.Z)(x,2),h=v[0],b=v[1],w=(0,u.useRef)(null);(0,u.useEffect)((function(){b(l.split(""))}),[l]);var p="wordbox";return c.wordIndex===e&&(p+=" wordbox-selected"),(0,i.jsx)("div",{tabIndex:0,className:p,ref:w,onClick:function(){s((function(n){return(0,o.Z)((0,o.Z)({},n),{},{wordIndex:e})}))},onBlur:function(){s({wordIndex:-1,charIndex:-1})},children:(0,i.jsx)(d,{charArray:h,wordIndex:e,selected:c,hint:f,mode:t,updateSelected:function(n){s({wordIndex:e,charIndex:n})}})})},d=function(n){for(var e=n.charArray,t=n.wordIndex,r=n.selected,o=n.hint,a=n.mode,u=n.updateSelected,c=[],s=null,d=function(n){s=l(t,n,r,o[n],a),c.push((0,i.jsxs)("div",{className:s,onClick:function(){return u(n)},children:[(0,i.jsx)("div",{className:"charbox-text",children:e[n]}),(0,i.jsx)("div",{className:"charbox-underline"})]},n))},f=0;f<e.length;f++)d(f);return(0,i.jsx)(i.Fragment,{children:c})},l=function(n,e,t,r,o){var a="charbox";return" "!==r&&(a+=" charbox-hint"),(e<o.overlapLen&&n>0||e>=o.wordLen-o.overlapLen&&n<o.noOfWords-1)&&(a+=" charbox-overlap"),n===t.wordIndex&&e===t.charIndex&&(a+=" charbox-selected"),a},f=(0,u.memo)(s),x=function(n){var e=n.keys,t=n.boardRef,r=function(n){n.preventDefault()};return(0,i.jsx)("div",{className:"d-flex flex-wrap align-items-center justify-content-center",children:e.map((function(n,e){return(0,i.jsx)("div",{className:"key-button",onClick:function(e){return function(n,e){var r=new KeyboardEvent("keydown_buttons",{key:n});t.current.dispatchEvent(r)}(n)},onMouseDown:r,children:n},e)}))})},v=-1,h=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=(0,u.useRef)(null),o=(0,u.useRef)(null);(0,u.useEffect)((function(){r.current=v,o.current=!1}),[]);var a=(0,u.useCallback)((function(){n(),o.current=!1,r.current=v}),[n]),c=(0,u.useCallback)((function(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&n.preventDefault(),o.current||(r.current=setTimeout(a,t),o.current=!0)}),[t,a]),i=(0,u.useCallback)((function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&n.preventDefault(),r.current!==v&&o.current&&(clearTimeout(r.current),r.current=v),o.current&&e(),o.current=!1}),[e]);return{onMouseDown:function(n){return c(n)},onTouchStart:function(n){return c(n,!1)},onMouseUp:function(n){return i(n)},onTouchEnd:function(n){return i(n)}}},b=t(917),w=t(8587),p=(0,u.lazy)((function(){return t.e(391).then(t.bind(t,4391))})),m={res:null,data:""},k=function(n){var e=(0,u.useState)(w.BH),t=(0,a.Z)(e,2),s=t[0],d=t[1],l=(0,u.useState)(w.vJ),v=(0,a.Z)(l,2),h=v[0],k=v[1],I=(0,u.useState)([]),E=(0,a.Z)(I,2),j=E[0],y=E[1],Z=(0,u.useState)({wordIndex:-1,charIndex:-1}),N=(0,a.Z)(Z,2),g=N[0],R=N[1],S=(0,u.useState)(m),L=(0,a.Z)(S,2),A=L[0],q=L[1],D=(0,u.useState)(!1),T=(0,a.Z)(D,2),B=T[0],O=T[1],W=(0,c.lr)(),z=(0,a.Z)(W,2),H=z[0],K=(z[1],(0,u.useRef)(null));(0,u.useEffect)((function(){var n,e=H.get("puzzle");n=null!==e?b.q.genPuzzleFromEncoded(e):b.q.genPuzzle(),d(b.q.getMode().data),k(n.data),y(b.q.getKeys().data),O(!1),q(m)}),[H]);var P=function(n){q(m);var e=n.key.toUpperCase(),t=g.wordIndex,a=g.charIndex;if(-1!==t){if(a>=s.wordLen||a<0)if(1===e.length&&-1===a)a=0;else if("ENTER"!==e)return;var u=(0,r.Z)(h.inputs),c=u[t].split(""),i=h.hints[t];1===e.length?(a<s.wordLen&&" "===i[a]&&(c[a]=e,u[t]=c.join(""),k((function(n){return(0,o.Z)((0,o.Z)({},n),{},{inputs:u})}))),a<s.wordLen-1?a++:a===s.wordLen-1&&t<s.noOfWords-1&&(a=0,t++)):"DELETE"===e||"BACKSPACE"===e?(" "===i[a]&&(c[a]=" ",u[t]=c.join(""),k((function(n){return(0,o.Z)((0,o.Z)({},n),{},{inputs:u})}))),"BACKSPACE"===e&&(a>0?a--:0===a&&t>0&&(a=s.wordLen-1,t--))):"ENTER"===e?function(n,e){q(m);var t=b.q.validateInput(n,e);q(t)}(t,c.join("")):"ARROWLEFT"===e?a>0?a--:0===a&&t>0&&(a=s.wordLen-1,t--):"ARROWRIGHT"===e?a<s.wordLen-1?a++:a===s.wordLen-1&&t<s.noOfWords-1&&(a=0,t++):"ARROWUP"===e?t>0&&t--:"ARROWDOWN"===e&&t<s.noOfWords-1&&t++,R({wordIndex:t,charIndex:a})}},M=function(n){var e=new KeyboardEvent("keydown_buttons",{key:n});K.current.dispatchEvent(e)};return(0,u.useEffect)((function(){var n=K.current;return n.addEventListener("keydown_buttons",P),function(){n.removeEventListener("keydown_buttons",P)}}),[P]),(0,i.jsxs)("div",{className:"container board",children:[(0,i.jsx)("div",{tabIndex:0,className:"board-panel",ref:K,onKeyDown:P,children:h.inputs.map((function(n,e){return(0,i.jsx)(f,{wordIndex:e,mode:s,state:h,selected:g,setSelected:R},e)}))}),(0,i.jsxs)("div",{className:"board-control",children:[(0,i.jsx)("div",{className:"board-status",children:"".concat(A.data)}),(0,i.jsx)(C,{onClickClear:function(){q(m);var n=(0,o.Z)({},h);n.inputs=(0,r.Z)(n.hints),k(n)},onClickHint:function(){q(m);var n=null;if((n=-1===g.charIndex?b.q.addHint(g.wordIndex):b.q.addHint(g.wordIndex,g.charIndex)).status===w.bb){var e=(0,o.Z)({},h),t=K.current.getElementsByClassName("wordbox")[g.wordIndex].textContent;e.hints=(0,r.Z)(b.q.getHints().data),e.inputs[g.wordIndex]=t.slice(0,n.data.index)+n.data.hint+t.slice(n.data.index+1),k(e)}else q(n)},onClickSubmit:function(){q(m);var n=Array.from(K.current.getElementsByClassName("wordbox")).map((function(n){return n.textContent})),e=b.q.validateAll(n);q(e),e.status===w.bb&&O(!0)},onClickValid:function(){return M("ENTER")},onClickBackspace:function(){return M("BACKSPACE")}}),(0,i.jsx)(x,{keys:j,boardRef:K})]}),(0,i.jsx)(u.Suspense,{children:(0,i.jsx)(p,{show:B,inputs:h.inputs,dismiss:function(){return O(!1)}})})]})},C=function(n){var e=n.onClickClear,t=n.onClickHint,r=n.onClickSubmit,a=n.onClickValid,u=n.onClickBackspace,c=h(e,u),s=h(r,a);return(0,i.jsxs)("div",{children:[(0,i.jsx)("i",{className:"fa-solid fa-2x fa-square-h board-icon-button",onClick:t,onMouseDown:function(n){return n.preventDefault()}}),(0,i.jsx)("i",(0,o.Z)({className:"fa-regular fa-2x fa-circle-check board-icon-button"},s)),(0,i.jsx)("i",(0,o.Z)({className:"fa-solid fa-2x fa-left-long board-icon-button"},c))]})},I=(0,u.memo)(k)}}]);
//# sourceMappingURL=353.b5d98e74.chunk.js.map